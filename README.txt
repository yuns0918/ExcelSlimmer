ExcelSuite - Excel 통합 파이프라인 도구
=====================================

이 폴더는 다음 세 가지 도구를 한 번에 파이프라인으로 실행하는 통합 런처입니다.

1) ExcelCleaner (이름 정의 정리)
2) Excel Image Slimmer (이미지 리사이즈/압축)
3) Excel Slimmer - Precision Plus (정밀 용량 감소)

통합 UI에서 한 번에 파일을 선택하고, 원하는 기능만 체크해서
순서대로 자동 실행할 수 있습니다.

--------------------------------------------------
폴더 구조 (개발/빌드용)
--------------------------------------------------

C:\Users\...\Desktop\ExcelCleaner\
C:\Users\...\Desktop\ExcelImageOptimization\
C:\Users\...\Desktop\ExcelByteReduce\
C:\Users\...\Desktop\ExcelSuite\  <-- 이 폴더 (현재)

위와 같이 네 폴더가 같은 Desktop 아래에 있다고 가정합니다.
(통합 exe를 빌드/테스트할 때만 필요하며,
최종 배포 시에는 EXE 1개만 전달하면 됩니다.)


--------------------------------------------------
1. 준비: 가상환경 및 패키지 설치 (install.bat)
--------------------------------------------------

1) Windows에서 ExcelSuite 폴더로 들어가서
   "install.bat" 를 더블클릭 실행

2) 스크립트가 자동으로 다음을 수행합니다.
   - .venv_suite 가상환경 생성 (없으면 생성, 있으면 재사용)
   - pip / wheel / setuptools 업그레이드
   - 필수 패키지 설치
     * pillow
     * lxml
     * pyinstaller

3) 완료 후 [OK] 메시지가 나오면 준비 완료입니다.


--------------------------------------------------
2. 개발/테스트: 통합 도구 실행 (run.bat)
--------------------------------------------------

1) ExcelSuite 폴더에서 "run.bat" 실행
2) .venv_suite 가상환경이 활성화되고
   "excel_suite_pipeline.py"를 Python으로 직접 실행합니다.
3) 뜨는 UI에서:
   - [파일 찾기] 버튼으로 대상 .xlsx/.xlsm 선택
   - 실행할 기능 체크
     * 이름 정의 정리
     * 이미지 최적화
     * 정밀 슬리머
   - [선택한 기능 실행] 버튼 클릭
4) 하단 로그와 상태를 보면서 진행 상황을 확인할 수 있습니다.


--------------------------------------------------
3. 배포용 단일 EXE 빌드 (build.bat)
--------------------------------------------------

1) ExcelSuite 폴더에서 "build.bat" 실행
2) 스크립트가 자동으로:
   - 이전 build/dist 폴더를 정리
   - PyInstaller를 이용해 단일 EXE 생성
     * dist\ExcelSuitePipeline.exe
3) [OK] 메시지가 나오면 빌드 성공입니다.

※ dist\ExcelSuitePipeline.exe 파일 하나만
   다른 사람에게 전달하면 됩니다.
   (상대방 PC에는 Python이 설치되어 있지 않아도 됩니다.)


--------------------------------------------------
4. 보안/안전 관련 메모
--------------------------------------------------

- 이 통합 도구는 다음과 같은 작업만 수행합니다.
  * 선택한 Excel 파일(.xlsx/.xlsm)을 임시 폴더에 압축 해제
  * 이미지 파일 리사이즈/압축
  * workbook/xml, customXml 등 특정 XML/리소스 정리
  * 결과 파일을 새 이름으로 저장 (원본은 백업 또는 유지)
- 네트워크 통신, 자기 복제, 레지스트리 조작 등
  악성코드로 오해받을 만한 동작은 포함되어 있지 않습니다.
- 최종 EXE는 PyInstaller가 Python 인터프리터와 필요한
  라이브러리(pillow, lxml 등)를 함께 하나의 파일로 묶은 것입니다.


--------------------------------------------------
5. 기타
--------------------------------------------------

- 정밀 슬리머 옵션
  * 공격 모드: 이미지 리사이즈 및 PNG→JPG 변환(알파 없는 경우)
  * XML 정리: calcChain, printerSettings 등 안전한 요소 제거
  * 숨은 XML 데이터 삭제(customXml): 주의가 필요한 옵션
  * 백업 안 만들기: .backup 파일 생성 생략 (권장하지 않음)

- 필요에 따라 ExcelCleaner / ImageOptimization / ByteReduce
  각 폴더 내 스크립트를 수정하면, 통합 도구도 그 로직을 그대로
  사용합니다 (단, 기능 이름/함수 시그니처를 크게 바꾸는 경우
  excel_suite_pipeline.py 쪽도 함께 수정해야 합니다).
